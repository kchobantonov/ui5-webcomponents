"use strict";import d from"../getSharedResource.js";import g from"./insertOpenUI5PopupStyles.js";const p=d("AllOpenedPopupsRegistry",{openedRegistry:[]}),a=e=>{p.openedRegistry.push(e)},u=e=>{const o=p.openedRegistry.findIndex(t=>t.instance===e);o>-1&&p.openedRegistry.splice(o,1)},h=()=>p.openedRegistry[p.openedRegistry.length-1].instance,l=e=>{for(let o=p.openedRegistry.length-1;o>=0;o--){const t=p.openedRegistry[o];if(t.type==="WebComponent")return!0;if(t.instance===e)break}return!1},f=e=>{e.setAttribute("popover","manual"),e.showPopover()},O=e=>{e.hasAttribute("popover")&&(e.hidePopover(),e.removeAttribute("popover"))},y=(e=document)=>e.querySelector(":popover-open")?!0:Array.from(e.querySelectorAll("*")).some(o=>{const t=o.shadowRoot;return t&&y(t)}),P=e=>{const o=e.prototype.onsapescape;e.prototype.onsapescape=function(...n){l(this.oPopup)||o.apply(this,n)}},m=e=>{const o=e.prototype.open;e.prototype.open=function(...n){o.apply(this,n);const s=y();if(["OPENING","OPEN"].includes(this.getOpenState())&&s){const r=this.getContent();if(r){const i=r instanceof HTMLElement?r:r?.getDomRef();i&&f(i)}}a({type:"OpenUI5",instance:this})}},v=e=>{const o=e.prototype._closed;e.prototype._closed=function(...n){const s=this.getContent(),c=s instanceof HTMLElement?s:s?.getDomRef();o.apply(this,n),c&&O(c),u(this)}},I=e=>{const o=e.prototype.onFocusEvent;e.prototype.onFocusEvent=function(...n){l(this)||o.apply(this,n)}},S=()=>{const e=new CSSStyleSheet;e.replaceSync(".sapMPopup-CTX:popover-open { inset: unset; }"),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]},C=(e,o)=>{g(),m(e),v(e),S(),I(e),P(o)};export{C as patchPopup,a as addOpenedPopup,u as removeOpenedPopup,h as getTopmostPopup};
//# sourceMappingURL=patchPopup.js.map
